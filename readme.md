# README

## Project Overview

This project consists of a series of Python scripts designed to create a book from screenshots and generate a video from the content. The process involves capturing screenshots, processing them into text, generating PDF and text versions of the book, and finally creating a video with audio and splitting it into manageable segments if necessary.

## Prerequisites

Before running the scripts, ensure you have the following installed:

- **Python 3.x**
- **Virtual Environment (venv) module**
- **Pip package manager**

Additionally, you need to have the following external tools installed:

- **Tesseract OCR**: For optical character recognition.
- **FFmpeg**: For video and audio processing.
- **LaTeX distribution**: Specifically, **XeLaTeX** for compiling LaTeX files.

## Setting Up a Virtual Environment

It's recommended to run the scripts in a virtual environment to manage dependencies.

### On Mac and Ubuntu:

1. Open a terminal.

2. Navigate to your project directory:

   ```bash
   cd /path/to/your/project
   ```

3. Create a virtual environment named `venv`:

   ```bash
   python3 -m venv venv
   ```

4. Activate the virtual environment:

   ```bash
   source venv/bin/activate
   ```

## Installing Required Python Packages

While in the virtual environment, install the required Python packages:

```bash
pip install Pillow pytesseract openai
```

- **Pillow**: Python Imaging Library for image processing.
- **pytesseract**: Python wrapper for Tesseract OCR.
- **openai**: OpenAI API client library.

## External Dependencies

### Tesseract OCR

- **Mac**: Install using Homebrew:

  ```bash
  brew install tesseract
  ```

- **Ubuntu**: Install via apt:

  ```bash
  sudo apt-get install tesseract-ocr
  ```

### FFmpeg

- **Mac**: Install using Homebrew:

  ```bash
  brew install ffmpeg
  ```

- **Ubuntu**: Install via apt:

  ```bash
  sudo apt-get install ffmpeg
  ```

### LaTeX Distribution

- **Mac**: Install MacTeX from [tug.org/mactex](https://tug.org/mactex/).

- **Ubuntu**: Install TeX Live:

  ```bash
  sudo apt-get install texlive-full
  ```

Ensure that `xelatex` is included in your LaTeX distribution.

## OpenAI API Key

The script `gpt-process-json.py` requires an OpenAI API key.

1. Sign up or log in to [OpenAI](https://platform.openai.com/).

2. Obtain your API key from the dashboard.

3. Replace the placeholder in `gpt-process-json.py`:

   ```python
   API_KEY = "your-openai-api-key"
   ```

## Order of Execution

Run the scripts in the following order:

1. **`json-screenshot.py`**
2. **`gpt-process-json.py`**
3. **`json-pdf-book.py`**
4. **`gen-video.py`**
5. **`split_video.py`** (if the generated video is longer than 10 hours)

---

## Script Descriptions and Instructions

### 1. `json-screenshot.py`

#### Purpose

Captures screenshots or adds existing images to create a structured JSON file representing a book with chapters and sections.

#### How to Run

Ensure your virtual environment is activated.

```bash
python json-screenshot.py
```

#### What It Does

- **Starts by asking**:

  - Whether to create a new JSON file or use an existing one.
  - The name for the new or existing JSON file.
  - The name of the first chapter and section.

- **Allows you to**:

  - Capture new screenshots (on macOS) using the `screencapture` command.
  - Add existing images to the current section.
  - Start new sections and chapters.

- **Stores**:

  - Images in a structured directory format.
  - Metadata about chapters, sections, and images in a JSON file.

#### User Interaction

- **Commands during execution**:

  - Press **Enter** to continue.
  - Type `'s'` or `'screenshot'` to capture a new screenshot.
  - Type `'n'` or `'next'` to start a new section.
  - Type `'c'` or `'chapter'` to start a new chapter.
  - Type `'I'` or `'i'` to add an image to the chapter.
  - Paste an image path and press Enter to add it to the current section.
  - Type `'exit'` to quit the program.

#### Small Snippet of Functionality

The script initializes a JSON structure to represent the book's hierarchy. It allows the user to:

- Create chapters and sections.
- Add images to sections.
- Capture screenshots on macOS.
- Save the data structure to a JSON file for later processing.

### 2. `gpt-process-json.py`

#### Purpose

Processes the JSON file generated by `json-screenshot.py`, extracts text from images using OCR, and sends the text to the OpenAI API for processing and enhancement.

#### How to Run

Ensure your virtual environment is activated.

```bash
python gpt-process-json.py
```

#### What It Does

- **Asks for**:

  - The name of the book (used in prompts to OpenAI).
  - The path to the JSON file.

- **Processes each section**:

  - Extracts text from images using Tesseract OCR.
  - Sends the extracted text to OpenAI's GPT model for refinement and expansion.
  - Saves the processed text back into the JSON structure.

- **Logs progress**:

  - Saves logs in `./gpt-logs/`.
  - Supports resuming processing by keeping track of processed sections.

#### User Interaction

- **Prompts for**:

  - The name of the book.
  - The path to your JSON file.

#### Small Snippet of Functionality

The script iterates over each section in the JSON file, extracts text from images using OCR, and sends the text to OpenAI's GPT-4 model to enhance and expand it, ensuring the original meaning remains intact. The processed text is then saved back into the JSON file.

**Note**: Ensure you have replaced the `API_KEY` placeholder in the script with your actual OpenAI API key.

### 3. `json-pdf-book.py`

#### Purpose

Generates a LaTeX document and a plain text version of the book from the processed JSON file. It then compiles the LaTeX document into a PDF and also creates a Markdown version.

#### How to Run

Ensure your virtual environment is activated.

```bash
python json-pdf-book.py
```

#### What It Does

- **Asks for**:

  - The path to the processed JSON file.
  - The base name for the output files (without extension).

- **Generates**:

  - LaTeX code for the book.
  - Plain text content.
  - Markdown content.

- **Compiles**:

  - The LaTeX code into a PDF using `xelatex`.

- **Saves**:

  - The PDF in `./pdf-book/`.
  - The plain text file in `./txt-books/`.
  - The Markdown file in `./markdown-books/`.

#### User Interaction

- **Prompts for**:

  - The path to the JSON file.
  - The base name for the output files.

#### Small Snippet of Functionality

The script reads the JSON data and converts it into LaTeX format, handling special characters and formatting. It compiles the LaTeX file into a PDF and also produces plain text and Markdown versions of the book.

### 4. `gen-video.py`

#### Purpose

Creates a video from a single image and combines it with an audio file to produce a final video.

#### How to Run

Ensure your virtual environment is activated.

```bash
python gen-video.py
```

#### What It Does

- **Asks for**:

  - The full path to the image.
  - The full path to the audio file.

- **Processes**:

  - Converts the image into a video of a specified duration (default 10 seconds).
  - Combines the video with the audio to produce the final output video.

- **Outputs**:

  - The final video is saved in the same directory as the image.

#### User Interaction

- **Prompts for**:

  - The full path to the image.
  - The full path to the audio file.

#### Small Snippet of Functionality

The script uses FFmpeg to create a video from a still image and then combines it with an audio file. This is useful for creating videos where the image remains static while the audio plays.

### 5. `split_video.py`

#### Purpose

Splits a long video into smaller segments if the total duration exceeds a specified length (e.g., 10 hours).

#### How to Run

Ensure your virtual environment is activated.

```bash
python split_video.py
```

#### What It Does

- **Checks**:

  - The duration of the input video.

- **Splits**:

  - If the video exceeds the specified length (default 10 hours, which is 36,000 seconds), it splits the video into smaller parts.

- **Outputs**:

  - Segmented video files in the same directory as the original video.

#### User Interaction

- **Set the video path**:

  - Modify the `video_path` variable in the script to point to your video file.

#### Small Snippet of Functionality

The script uses FFmpeg to split the input video into multiple segments based on the specified segment length. It is helpful when you need to upload videos to platforms that have maximum duration limits.

---

## Additional Notes

- **Ensure Paths are Correct**: When providing paths to files, ensure they are correct and accessible by the scripts.

- **Permissions**: You may need to adjust file permissions to allow scripts to read and write files.

- **External Tools**: The scripts rely on external tools like Tesseract OCR, FFmpeg, and XeLaTeX. Ensure these are correctly installed and added to your system's PATH.

- **Error Handling**: The scripts include basic error handling but may need additional checks based on your environment.

- **OpenAI API Costs**: Be aware that using the OpenAI API may incur costs depending on your usage.

## Conclusion

By following the above instructions and running the scripts in order, you can generate a book from screenshots, process it into text and PDF formats, create a video with audio, and split the video into manageable segments.

Feel free to modify the scripts to suit your specific needs or to improve functionality.

---

# Shortened Answer

[As above.] The answer provides the requested README file, explaining how to run each file, what each file does, the order to run them, the required libraries, how to set up a virtual environment, and small explanations for each script.